<!-- 資産カードグリッド -->
<div class="asset-grid">
    <!-- 日本株カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='jp_stock') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #e8f5e9;">
                <span class="icon-text">JP</span>
                <span class="icon-flag-emoji">🇯🇵</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">日本株</div>
                <div class="card-amount-new {% if jp_total >= 1000000 %}amount-large{% elif jp_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(jp_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set jp_cost = jp_total - jp_profit %}
            {% set jp_profit_rate = (jp_profit / jp_cost * 100) if jp_cost > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if jp_profit > 0 %}positive{% elif jp_profit < 0 %}negative{% else %}zero{% endif %}">
                    {% if jp_profit > 0 %}+{% elif jp_profit < 0 %}-{% endif %}{{ "{:.1f}".format(jp_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if jp_profit > 0 %}profit-plus{% elif jp_profit < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if jp_profit > 0 %}+{% elif jp_profit < 0 %}-{% endif %}¥{{ "{:,.0f}".format(jp_profit|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if jp_day_change > 0 %}positive{% elif jp_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if jp_day_change > 0 %}+{% elif jp_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(jp_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if jp_day_change > 0 %}profit-plus{% elif jp_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if jp_day_change > 0 %}+{% elif jp_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(jp_day_change|abs) }}
            </div>
        </div>
    </a>
    
    <!-- 米国株カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='us_stock') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #e3f2fd;">
                <span class="icon-text">US</span>
                <span class="icon-flag-emoji">🇺🇸</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">米国株</div>
                <div class="card-amount-new {% if us_total_jpy >= 1000000 %}amount-large{% elif us_total_jpy >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(us_total_jpy) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set us_cost_jpy = us_total_jpy - us_profit_jpy %}
            {% set us_profit_rate = (us_profit_jpy / us_cost_jpy * 100) if us_cost_jpy > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if us_profit_jpy > 0 %}positive{% elif us_profit_jpy < 0 %}negative{% else %}zero{% endif %}">
                    {% if us_profit_jpy > 0 %}+{% elif us_profit_jpy < 0 %}-{% endif %}{{ "{:.1f}".format(us_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if us_profit_jpy > 0 %}profit-plus{% elif us_profit_jpy < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if us_profit_jpy > 0 %}+{% elif us_profit_jpy < 0 %}-{% endif %}¥{{ "{:,.0f}".format(us_profit_jpy|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if us_day_change > 0 %}positive{% elif us_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if us_day_change > 0 %}+{% elif us_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(us_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if us_day_change > 0 %}profit-plus{% elif us_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if us_day_change > 0 %}+{% elif us_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(us_day_change|abs) }}
            </div>
        </div>
    </a>
    
    <!-- 現金カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='cash') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #fff3e0;">
                <span class="icon-emoji">💰</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">現金</div>
                <div class="card-amount-new {% if cash_total >= 1000000 %}amount-large{% elif cash_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(cash_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if cash_day_change > 0 %}positive{% elif cash_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if cash_day_change > 0 %}+{% elif cash_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(cash_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if cash_day_change > 0 %}profit-plus{% elif cash_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if cash_day_change > 0 %}+{% elif cash_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(cash_day_change|abs) }}
            </div>
        </div>
    </a>
    
    <!-- 金カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='gold') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #fffde7;">
                <span class="icon-emoji">🥇</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">金(Gold)</div>
                <div class="card-amount-new {% if gold_total >= 1000000 %}amount-large{% elif gold_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(gold_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set gold_cost = gold_total - gold_profit %}
            {% set gold_profit_rate = (gold_profit / gold_cost * 100) if gold_cost > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if gold_profit > 0 %}positive{% elif gold_profit < 0 %}negative{% else %}zero{% endif %}">
                    {% if gold_profit > 0 %}+{% elif gold_profit < 0 %}-{% endif %}{{ "{:.1f}".format(gold_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if gold_profit > 0 %}profit-plus{% elif gold_profit < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if gold_profit > 0 %}+{% elif gold_profit < 0 %}-{% endif %}¥{{ "{:,.0f}".format(gold_profit|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if gold_day_change > 0 %}positive{% elif gold_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if gold_day_change > 0 %}+{% elif gold_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(gold_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if gold_day_change > 0 %}profit-plus{% elif gold_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if gold_day_change > 0 %}+{% elif gold_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(gold_day_change|abs) }}
            </div>
        </div>
    </a>
    
    <!-- 暗号資産カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='crypto') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #f3e5f5;">
                <span class="icon-bitcoin">₿</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">暗号資産</div>
                <div class="card-amount-new {% if crypto_total >= 1000000 %}amount-large{% elif crypto_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(crypto_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set crypto_cost = crypto_total - crypto_profit %}
            {% set crypto_profit_rate = (crypto_profit / crypto_cost * 100) if crypto_cost > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if crypto_profit > 0 %}positive{% elif crypto_profit < 0 %}negative{% else %}zero{% endif %}">
                    {% if crypto_profit > 0 %}+{% elif crypto_profit < 0 %}-{% endif %}{{ "{:.1f}".format(crypto_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if crypto_profit > 0 %}profit-plus{% elif crypto_profit < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if crypto_profit > 0 %}+{% elif crypto_profit < 0 %}-{% endif %}¥{{ "{:,.0f}".format(crypto_profit|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if crypto_day_change > 0 %}positive{% elif crypto_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if crypto_day_change > 0 %}+{% elif crypto_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(crypto_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if crypto_day_change > 0 %}profit-plus{% elif crypto_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if crypto_day_change > 0 %}+{% elif crypto_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(crypto_day_change|abs) }}
            </div>
        </div>
    </a>

    <!-- 投資信託カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='investment_trust') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #e0f2f1;">
                <span class="icon-emoji">📈</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">投資信託</div>
                <div class="card-amount-new {% if investment_trust_total >= 1000000 %}amount-large{% elif investment_trust_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(investment_trust_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set it_cost = investment_trust_total - investment_trust_profit %}
            {% set it_profit_rate = (investment_trust_profit / it_cost * 100) if it_cost > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if investment_trust_profit > 0 %}positive{% elif investment_trust_profit < 0 %}negative{% else %}zero{% endif %}">
                    {% if investment_trust_profit > 0 %}+{% elif investment_trust_profit < 0 %}-{% endif %}{{ "{:.1f}".format(it_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if investment_trust_profit > 0 %}profit-plus{% elif investment_trust_profit < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if investment_trust_profit > 0 %}+{% elif investment_trust_profit < 0 %}-{% endif %}¥{{ "{:,.0f}".format(investment_trust_profit|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if investment_trust_day_change > 0 %}positive{% elif investment_trust_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if investment_trust_day_change > 0 %}+{% elif investment_trust_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(investment_trust_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if investment_trust_day_change > 0 %}profit-plus{% elif investment_trust_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if investment_trust_day_change > 0 %}+{% elif investment_trust_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(investment_trust_day_change|abs) }}
            </div>
        </div>
    </a>

    <!-- 保険カード -->
    <a href="{{ url_for('assets.manage_assets', asset_type='insurance') }}" class="asset-card">
        <div class="card-header-new">
            <div class="card-icon" style="background: #e0f7fa;">
                <span class="icon-emoji">🛡️</span>
            </div>
            <div class="card-info">
                <div class="card-name-new">保険</div>
                <div class="card-amount-new {% if insurance_total >= 1000000 %}amount-large{% elif insurance_total >= 10000000 %}amount-xlarge{% endif %}">
                    ¥{{ "{:,.0f}".format(insurance_total) }}
                </div>
            </div>
        </div>
        <div class="card-details">
            {% set insurance_cost = insurance_total - insurance_profit %}
            {% set insurance_profit_rate = (insurance_profit / insurance_cost * 100) if insurance_cost > 0 else 0 %}
            <!-- 損益 -->
            <div class="detail-row">
                <span class="detail-label">損益</span>
                <span class="detail-badge {% if insurance_profit > 0 %}positive{% elif insurance_profit < 0 %}negative{% else %}zero{% endif %}">
                    {% if insurance_profit > 0 %}+{% elif insurance_profit < 0 %}-{% endif %}{{ "{:.1f}".format(insurance_profit_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if insurance_profit > 0 %}profit-plus{% elif insurance_profit < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if insurance_profit > 0 %}+{% elif insurance_profit < 0 %}-{% endif %}¥{{ "{:,.0f}".format(insurance_profit|abs) }}
            </div>
            <!-- 前日比 -->
            <div class="detail-row">
                <span class="detail-label">前日比</span>
                <span class="detail-badge {% if insurance_day_change > 0 %}positive{% elif insurance_day_change < 0 %}negative{% else %}zero{% endif %}">
                    {% if insurance_day_change > 0 %}+{% elif insurance_day_change < 0 %}-{% endif %}{{ "{:.1f}".format(insurance_day_change_rate|abs) }}%
                </span>
            </div>
            <div class="detail-amount {% if insurance_day_change > 0 %}profit-plus{% elif insurance_day_change < 0 %}profit-minus{% else %}zero{% endif %}">
                {% if insurance_day_change > 0 %}+{% elif insurance_day_change < 0 %}-{% endif %}¥{{ "{:,.0f}".format(insurance_day_change|abs) }}
            </div>
        </div>
    </a>
</div>

<style>
/* ✅ アイコン表示の改善 */
.card-icon {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* テキスト表示（JP/US）- フォールバック用 */
.icon-text {
    font-size: 24px;
    font-weight: 700;
    color: rgba(0, 0, 0, 0.2);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    position: absolute;
}

/* 国旗絵文字 - メイン表示 */
.icon-flag-emoji {
    font-size: 36px;
    line-height: 1;
    font-family: "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "Apple Color Emoji", "Android Emoji", sans-serif;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    position: relative;
    z-index: 1;
}

/* ビットコインマークのスタイル */
.icon-bitcoin {
    font-size: 36px;
    font-weight: 700;
    line-height: 1;
    font-family: Arial, "Segoe UI", sans-serif;
    color: #f7931a;
}

/* その他の絵文字スタイル */
.icon-emoji {
    font-size: 28px;
    line-height: 1;
    font-family: "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "Apple Color Emoji", "Android Emoji", sans-serif;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* デスクトップ対応 */
@media (min-width: 992px) {
    .icon-text {
        font-size: 28px;
    }
    
    .icon-flag-emoji {
        font-size: 44px;
    }
    
    .icon-bitcoin {
        font-size: 44px;
    }
    
    .icon-emoji {
        font-size: 36px;
    }
}

/* 金額の桁数に応じたフォントサイズ調整 */
.card-amount-new {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-primary);
    letter-spacing: -0.5px;
    transition: color 0.3s ease;
}

.card-amount-new.amount-large {
    font-size: 17px;
    letter-spacing: -0.8px;
}

.card-amount-new.amount-xlarge {
    font-size: 15px;
    letter-spacing: -1px;
}
</style>
